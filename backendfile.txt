this is the backend logic

updated by the code branch