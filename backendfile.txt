this is the backend logic